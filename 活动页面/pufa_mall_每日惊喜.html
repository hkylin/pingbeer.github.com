
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
    <link href="/XPMall/Content/css/dailySurprise.css" rel="stylesheet" />
    <link href="/XPMall/Content/css/dailySurpriseDetail.css" rel="stylesheet" />
    <link href="/XPMall/Content/css/seckill.css" rel="stylesheet" />
    <link href="/XPMall/Content/css/common.css" rel="stylesheet" />
    <link href="/XPMall/Content/css/index.css" rel="stylesheet" />
    <script src="/XPMall/Scripts/jquery-1.7.1.min.js"></script>
    <script src="/XPMall/Scripts/dailySurprise.js"></script>
    <script src="/XPMall/Scripts/APPCommon.js"></script>
    <link href="/XPMall/Content/css/swipe.css" rel="stylesheet" />
    <style type="text/css">
        .clearfix:after {
            clear: both;
            content: ".";
            display: block;
            font-size: 0;
            height: 0;
            visibility: hidden;
        }

        .clearfix {
            min-height: 1%;
        }
        /*returnTop*/
        p#back-to-top {
            position: fixed;
            display: none;
            bottom: 100px;
            right: 10px;
        }

            p#back-to-top a {
                text-align: center;
                text-decoration: none;
                color: #d1d1d1;
                display: block;
                width: 64px;
                /*使用CSS3中的transition属性给跳转链接中的文字添加渐变效果*/
                -moz-transition: color 1s;
                -webkit-transition: color 1s;
                -o-transition: color 1s;
            }
                /*p#back-to-top a:hover{
            color:#979797;
        }*/
                p#back-to-top a span {
                    background: transparent url(../../Content/images/upTop.png?1202) no-repeat 25px 29px;
                    border-radius: 6px;
                    /*display:block;*/
                    height: 64px;
                    width: 56px;
                    margin-bottom: 5px;
                    /*使用CSS3中的transition属性给<span>标签背景颜色添加渐变效果*/
                    -moz-transition: background 1s;
                    -webkit-transition: background 1s;
                    -o-transition: background 1s;
                }
        /*#back-to-top a:hover span{
            background:transparent url(../Images/orderedList1.png?1202) no-repeat -25px -290px;
        }*/
    </style>
    <style type="text/css">
        #slideView {
            position: absolute;
            overflow: hidden;
            background-color: Black;
            height: 212px;
            padding-top: 8px;
            width: 320px;
        }

        #divPlaceholder {
            height: 220px;
            width: 320px;
        }

        .slideContainer {
            position: absolute;
            background-color: black;
        }

        .block {
            position: absolute;
        }

            .block div {
                border: solid 2px black;
                margin: auto;
                margin-left: 60px;
                font-size: 1.5em;
                text-align: center;
                line-height: 30px;
                background-color: black;
            }

        ul, ol {
            list-style: none;
        }
    </style>
    <script type="text/javascript">
        function AutoResizeImage(maxWidth, maxHeight, objImg) {
            var img = new Image();
            img.src = objImg.src;
            var hRatio;
            var wRatio;
            var Ratio = 1;
            var w = img.width;
            var h = img.height;
            wRatio = maxWidth / w;
            hRatio = maxHeight / h;
            if (maxWidth == 0 && maxHeight == 0) {
                Ratio = 1;
            } else if (maxWidth == 0) {//
                if (hRatio < 1) Ratio = hRatio;
            } else if (maxHeight == 0) {
                if (wRatio < 1) {

                } else {

                }
                Ratio = wRatio;
            } else if (wRatio < 1 || hRatio < 1) {
                Ratio = (wRatio <= hRatio ? wRatio : hRatio);
            }
            if (Ratio < 1) {

            }
            w = w * Ratio;
            h = h * Ratio;
            var divWidth = $("div[data-index=1]").width();
            if ($("div[data-index=1]").val() == undefined) {
                divWidth = $("div[data-index=0]").width();
            }
            var f = divWidth / w;
            w = w * f;
            h = h * f;
            objImg.height = h;
            objImg.width = w;
        }

        $(function () {
            var w = 200;
            var h = 200;
            var divWidth = $("div[data-index=1]").width();
            if ($("div[data-index=1]").val() == undefined) {
                divWidth = $("div[data-index=0]").width();
            }
            var f = divWidth / w;
            w = w * f;
            h = h * f;
            $(".swipe-wrap img").each(function () { $(this).attr("width", w).attr("height", h) })
        })
    </script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?9745bf1457a94287b066e5bf56988a80";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</head>
<body style="background: rgb(255, 255, 255) none repeat scroll 0% 0%;">
    <a name="top"></a>

    <div class="topfixed">
        <header class="header">
            <a class="a-back"></a>
            <h2></h2>
            <div class="share-img">
                <img class="head-right" src="/XPMall/Content/images/orderpic.png" width="22%" style="margin-right:4%;" id="orderDetail">
                <img class="head-right2" src="/XPMall/Content/images/orderpic2.png" width="20%" id="share">
            </div>
        </header>
    </div>
    <div class="detail mt70" style="padding-top: 10px;" id="detail">
        <div class="addWrap" style="margin-top: 0px;">
            <div class="swipe" id="mySwipe">
                <div class="swipe-wrap">
                        <div><a href="javascript:;">
                            <img  onload="AutoResizeImage(400,0,this)"   src="https://img.soonwill.com/product/1/3/28/10/5/KiWkRMwd(538_538).jpg" /></a></div>


                </div>
            </div>
            <ul id="position" style="display: none;">
                    <li class="cur"></li>


            </ul>
        </div>

        <div id="detailInfo">
                <span>摩拜单车畅骑年卡  限时购</span><br>
                <del></del>
                <font>惊喜价：<strong>1.00</strong>元</font>


        </div>
    </div>
    <div class="creditInfo">
        <img src="/XPMall/Content/images/credit01.png" class="vm" width="15"><span><span class="blue">积分抵现</span></span>
        <span class="gray">|</span>
        <img src="/XPMall/Content/images/credit02.png" class="vm"  width="15"><span><a href="https://pufa.soonwill.com/XPMall/Product/ActivityIndex?ActivitySysNo=2&amp;MType=2">积分查询及支付说明</a></span>
    </div>
        <div class="seckill">

            <section id="hTitle">距离活动开始</section>
            <section id="hTime"><b id="bDay">10</b>天<b id="bHour">10</b>小时<b id="bMinute">10</b>分<b id="bSecond">10</b>秒</section>
            <section class="leave" id="hKC">还剩<b>365</b>件</section>
            <div class="clearer" id="hCl"></div>
        </div>
    <p id="back-to-top"><a href="#top"><span></span></a></p>
    <div class="color-choice menu">
        <ul>
            <li id="spms"><a href="#posi">商品描述</a></li>
            <li id="cs" class="right"><a href="#posi">参数</a></li>
        </ul>
        <div class="clearer"></div>
    </div>
    <div class="content" id="detailForApp">

    </div>
    <div class="content" id="performance" style="display: none;">
            <div style="padding-left: 5px; padding-right: 5px; overflow: hidden; position: relative;">
                <p></p>
            </div>
    </div>
    <div id="posi" class="posi"></div>
    <footer class="bottomDiv">
            <a href="javascript:submit();" title="立即购买" id="tBuy">立即购买</a>
        <span id="pSL">
            <input id="cnum" type="text" value="1" style="width: 30px;" maxlength="4" onblur="blurSL(this)">件</span>
        <span id="pJE">
                <font style="color: red;" id="iJEA">1.00 元</font>
        </span>
        <div class="clearer"></div>
    </footer>
    <input name="hidProductSaleType" id="hidProductSaleType" type="hidden" value="1" />
    <input name="hidProductSysNo" id="hidProductSysNo" type="hidden" value="32810" />
    <input name="hidGroupNumber" id="hidGroupNumber" type="hidden" value="32810" />
    <input name="hidInventoryQty" id="hidInventoryQty" type="hidden" value="365" />
    <input name="hidPrice" id="hidPrice" type="hidden" value="1.00" />
    <input name="hidPeriod" id="hidPeriod" type="hidden" value="1" />
    <input name="hidPeriodPrice" id="hidPeriodPrice" type="hidden" value="1.00" />
    <input name="hidTotalPrice" id="hidTotalPrice" type="hidden" value="1.00" />
    <input name="hidMinQty" id="hidMinQty" type="hidden" value="1" />
    <input name="hidMaxQty" id="hidMaxQty" type="hidden" value="1" />
    <input name="hidMType" id="hidMType" type="hidden" />
    <input name="hidIsSecKill" id="hidIsSecKill" type="hidden" value="1" />
    <input name="hidSecStartTime" id="hidSecStartTime" type="hidden" value="2017/3/22 10:00:00" />
    <input name="hidSecEndTime" id="hidSecEndTime" type="hidden" value="2017/3/23 23:55:50" />
    <input name="hidNewTime" id="hidNewTime" type="hidden" value="2017/3/22 9:49:25" />
    <input name="hidProductName" id="hidProductName" type="hidden" value="摩拜单车畅骑年卡  限时购" />
    <input name="hidIsKillEnable" id="hidIsKillEnable" type="hidden" value="0" />
    <input name="hidClickDetailForApp" id="hidClickDetailForApp" type="hidden" />
    <input type="hidden" id="secondPage" />
    <div id="LoadingDiv" class="LoadingStyle" style="display: none;">
        <img class="LoadingStyle" alt="" src="/XPMall/content/images/Loading.gif">
    </div>
    <div class="MaskPanel"></div>
    <div class="MaskContent" style="margin-left: -131px;">
        <section class="section3">
            <p class="b-Tel" style="text-align: center;"></p>
            <div class="M-sure" style="text-align: center;">
                <input onclick="closeMask();" type="button" class="inputFour" value="我知道了" style="display: none;" />
            </div>
        </section>
    </div>
<form action="/XPMall/Order/OrderConfirm" id="formCollectCart" method="post">        <input type="hidden" name="hidPostData" id="hidPostData" value="" />
</form>    <!--20151008 write begin-->
    <!--poplayer begin-->
    <div class="poplayer undis"></div>
    <div class="poplayerCont undis">
        <div class="poplayerTitle">
            <span>分享到</span>
        </div>
        <ul class="share clearfix">
            <li>
                <a href="#" id="wxhys">
                    <img src="/XPMall/Content/images/wxhy.png" width="60" height="60"></a>
                <p>微信好友</p>
            </li>
            <li>
                <a href="#" id="pyqs">
                    <img src="/XPMall/Content/images/pyq.png" width="60" height="60"></a>
                <p>朋友圈</p>
            </li>
        </ul>
        <div class="shareDiv">
            <input type="button" value="取消" class="cancelShare" id="cancelShare" />
        </div>
    </div>
    <!--poplayer end-->
    <div class="blackBg undis"></div>
    <script type="text/javascript">
        $(function () {
            $("#share").bind("click", function () {
            var version;
            try {
                //var version = jsspdb.checkVersion();//'';
                version = '1#3.2.3';
            } catch (err) {
            }
            if (!version) {
                showWaitingMask("未能获取到APP版本信息");
                return false;
            }
            var RVersion = version.split('#');
            if (RVersion[0] == 1) {//APP
                version = RVersion[1];
                var mV1 = version.split('.')[0];
                var mV2 = version.split('.')[1];
                var mV3 = version.split('.')[2];
                if (RVersion[0] == '1') {//Android分享
                    if (parseInt(mV1) < 2) {
                        showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                        return false;
                    }
                    if (parseInt(mV1) == 2) {
                        if (parseInt(mV2) < 4) {
                            showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                            return false;
                        }
                        if (parseInt(mV2) == 4) {
                            if (parseInt(mV3) <= 2) {
                                showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                                return false;
                            }
                        }
                    }
                } else {//IOS分享
                    if (parseInt(mV1) < 1) {
                        showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                        return false;
                    }
                    if (parseInt(mV1) == 1) {
                        if (parseInt(mV2) < 4) {
                            showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                            return false;
                        }
                        if (parseInt(mV2) == 4) {
                            if (parseInt(mV3) <= 1) {
                                showWaitingMask("请升级新版浦大喜奔APP使用此功能");
                                return false;
                            }
                        }
                    }
                }
            } else {
            }


            var height = $(document).height();
            $(".blackBg").css("height", height);
            $(".poplayer").show();
            $(".poplayerCont").show();
            $(".blackBg").show();
        });
        $("#cancelShare").bind("click", function () {
            $(".poplayer").hide();
            $(".poplayerCont").hide();
            $(".blackBg").hide();
        });
        $("#wxhys").click(function () {
            var mProductName = $("#hidProductName").val();
            var mProductContent = mProductName;
            var mUrl = 'https://pufa.soonwill.com/xpmall' + "/Product/ProductDetail?ProductSysNo=" + $.trim($("#hidProductSysNo").val()) + "&MType=" + $.trim($("#hidMType").val());
            //jsspdb.shareToWXSceneSession(mUrl, mProductName, mProductContent);
            jsspdb.shareToWXSceneSession(mUrl, mProductName, mProductContent, 0);
            $("#cancelShare").click();
        });
        $("#pyqs").click(function () {
            var mProductName = $("#hidProductName").val();
            var mProductContent = mProductName;
            var mUrl = 'https://pufa.soonwill.com/xpmall' + "/Product/ProductDetail?ProductSysNo=" + $.trim($("#hidProductSysNo").val()) + "&MType=" + $.trim($("#hidMType").val());
            //jsspdb.shareToWXSceneTimeline(mUrl, mProductName, mProductContent);
            jsspdb.shareToWXSceneTimeline(mUrl, mProductName, mProductContent, 0);
            $("#cancelShare").click();
        });
    });
    </script>
    <!--20151008 write end-->
</body>
</html>
<script type="text/javascript" src="/XPMall/Scripts/slide.js"></script>
<script src="/XPMall/Scripts/swipe.js"></script>
<script type="text/javascript">
    var bullets = document.getElementById('position').getElementsByTagName('li');
    var banner = Swipe(document.getElementById('mySwipe'), {
        auto: 2000,
        continuous: true,
        disableScroll: true,
        callback: function (pos) {
            var i = bullets.length;
            while (i--) {
                bullets[i].className = ' ';
            }
            bullets[pos].className = 'cur';
        }
    });
</script>
<script type="text/javascript">
    $(function () {

        //当滚动条的位置处于距顶部100像素以下时，跳转链接出现，否则消失
        $(function () {
            $(window).scroll(function () {
                if ($(window).scrollTop() > 100) {
                    $("#back-to-top").fadeIn(1500);
                }
                else {
                    $("#back-to-top").fadeOut(1500);
                }
            });

            //当点击跳转链接后，回到页面顶部位置

            $("#back-to-top").click(function () {
                $('body,html').animate({ scrollTop: 0 }, 1000);
                return false;
            });
        });

        var params = "?ProductSysNo=32810";
        //firstLoad(params);
        $(".a-back").click(function () {
            var bk = '';
            if (bk && bk.length > 5) {
                window.location = '';
            } else {

                goback();
            }
        });
        $("#orderDetail").click(function () {

                goorderInfo();
            //}
        });
        $("#spms").click(function () {
            $("#detailForApp").show();
            $("#performance").hide();
            $("#spms").attr("class", "on");
            $("#cs").removeAttr("class");
            $("#cs").attr("class", "right");
        });
        $("#cs").click(function () {
            $("#detailForApp").hide();
            $("#performance").show();
            $("#cs").attr("class", "on");
            $("#spms").removeAttr("class");
        });
        //$(".color-choice li").click(function () {
        //    $(this).siblings().removeAttr("class");
        //    $(this).attr("class", "on");

        //});
        //$("#colorX li").click(function () {
        //    $(this).siblings().removeAttr("class");
        //    //$(this).attr("class", "on");
        //});
        $("#spms").click(function () {
            //加载商品描述
            var productSysNos = $("#hidProductSysNo").val();
            var hidClickProductSysNos = $("#hidClickDetailForApp").val();
            if (productSysNos == hidClickProductSysNos) {
                return false;//不用刷新
            }
            var params = "?ProductSysNo=" + productSysNos + "&isSecKill=" + $("#hidIsSecKill").val();
            $.ajax({
                url: '/XPMall/Product/LoadProductDetailForApp' + params,
                type: 'post',
                dataType: "json",
                beforeSend: function () {
                    //提示加载
                    $("#LoadingDiv").show();
                },
                complete: function () {
                    $("#LoadingDiv").hide();
                },
                error: function (a, b, c) {
                    var errorMsg = "出现JS异常，异常页面：" + window.location.href + ";错误信息：" + a.status + "_" + b + "_" + c;
                    window.location = '/XPMall/Share/Error' + "?ErrorMsg=" + errorMsg;
                },
                success: function (data) {
                    var jsonData = data;
                    if (jsonData.Code == 1 || jsonData.Code == -1) {
                        showWaitingMask(jsonData.Message);
                    } else {
                        var Data = jsonData.Data;
                        $("#detailForApp").empty();
                        $("#hidClickDetailForApp").val(productSysNos);
                        var items;
                        item = "  <div style=\"padding-left: 5px; padding-right: 5px;overflow: hidden;  position: relative;\"> ";
                        item += " <p>" + Data.DetailForApp + "</p> ";
                        item += " </div> ";
                        item += " <dl style=\"font-weight: 600;\"><dt>【商品编号】</dt><dd>" + Data.ProductID + "</dd></dl> ";
                        item += " <dl><dt>【商品简介】</dt><dd>" + Data.BriefDesc + "</dd></dl> ";
                        item += " <dl><dt>【促销标题】</dt><dd>" + Data.PromotionTitle + "</dd></dl> ";
                        item += " <dl><dt>【保修信息】</dt><dd>" + Data.Warranty + "</dd></dl> ";
                        item += " <dl><dt>【注意事项】</dt><dd>" + Data.Attention + "</dd></dl> ";
                        item += " <dl><dt>【包装信息】</dt><dd>" + Data.PackageList + "</dd></dl> ";
                        item += " <dl><dt>【商家信息】</dt><dd>" + Data.VendorName + "</dd><dd>服务电话：" + Data.ServicePhone + "</dd><dd>服务时间：" + Data.ServiceHours + "</dd></dl> ";
                        item += " <dl style=\"font-weight: 600;\"><dt>【预计发货时间】</dt><dd>" + Data.ForecastSendTime + "</dd></dl> ";
                        item += " <dl><dt>【免责声明】</dt><dd>1、本商品页面所发布的商品信息由供货商自行提供，其真实性、准确性和合法性由信息发布人负责。商城不承担任何法律责任。</dd><dd>2、本商品页面所发布商品的图片、字体、肖像等信息均由供货商负责提供。如涉及商品的图片、字体、肖像的版权争议，以及由商品信息引起的其他各种争议均由供货商负责。</dd></dl> ";
                        $("#detailForApp").append(item);
                    }
                }
            });
        });


    });

    function ShowDevice() {
        var m = -1;
        // 获取终端的相关信息
        var Terminal = {
            // 辨别移动终端类型
            platform: function () {
                var u = navigator.userAgent, app = navigator.appVersion;
                return {
                    // android终端或者uc浏览器
                    android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1,
                    // 是否为iPhone或者QQHD浏览器
                    iPhone: u.indexOf('iPhone') > -1,
                    // 是否iPad
                    iPad: u.indexOf('iPad') > -1
                };
            }(),
            // 辨别移动终端的语言：zh-cn、en-us、ko-kr、ja-jp...
            language: (navigator.browserLanguage || navigator.language).toLowerCase()
        }
        if (Terminal.platform.android) {
            m = 1;
            //alert("安卓");
        } else if (Terminal.platform.iPhone) {
            m = 2;
            //alert("IPhone");
        } else if (Terminal.platform.iPad) {
            m = 3;
            //alert("IPAD");
        } else {
            m = 3;
            //alert("其他");
        }
        return m;
    }

    function goback() {


        var version;
        try {
            version = '1#3.2.3';
            //version = jsspdb.checkVersion();
        } catch (err) {
        }
        if (!version) {
            version = "1#3.0.0";
        }
        var RVersion = version.split('#');
        if (RVersion[0] == 1) {//APP
            version = RVersion[1];
            var mV1 = version.split('.')[0];
            var mV2 = version.split('.')[1];
            var mV3 = version.split('.')[2];
            var devices = ShowDevice();
            if (devices == 1) {//Android
                //if (parseInt(mV1) <= 2) {
                //    window.jsspdb.xpMallGoBack();
                //}
                //else {
                //    window.jsspdb.lifeGoBack();
                //}
                var params = "?a=1";
                window.location = 'https://pufa.soonwill.com/xpmall/Home/Index' + params;
            } else if (devices == 2) {//Iphone
                if (parseInt(mV1) <= 2) {
                    document.location = "jsspdb:;mallCall:,close";
                }
                else {
                    document.location = "jsspdb:;lifeCall:,close";
                }
            } else {
                var params = "?a=1";
                window.location = 'https://pufa.soonwill.com/xpmall/Home/Index' + params;
            }
        } else {
            var params = "?a=1";
            window.location = 'https://pufa.soonwill.com/xpmall/Home/Index' + params;
        }

}
function goorderInfo() {

        var params = "?a=1";
        window.location = '/XPMall/Order/OrderList' + params;
    }

    function submit() {
        var temp = [];
        var data = {};
        var productSysNo = $("#hidProductSysNo").val();
        var cnum = $("#cnum").val();
        cnum = parseInt(cnum);
        if ($("#hidTotalPrice").val() == "NaN" || cnum == "NaN") {
            showWaitingMask("数据异常请重新下单");
            return false;
        }
        var qty = $("#hidInventoryQty").val();
        qty = parseInt(qty);
        var minqty = $("#hidMinQty").val();
        var maxqty = $("#hidMaxQty").val();//后续判断最大和最小库存
        if (minqty < 1) {
            minqty = 1;
        }
        if (qty <= 0) {
            $("#cnum").val(0);
            showWaitingMask("商品可用库存不足,不能购买");
            return false;
        }
        var isMinKC = false;//判断库存是否小于最大限购数量
        if (qty < maxqty) {
            maxqty = qty;
            isMinKC = true;
        }
        if (cnum > maxqty) {
            if (isMinKC) {
                showWaitingMask("不能超过可用库存" + maxqty + "件");
            } else {
                showWaitingMask("不能超过最大购买数量" + maxqty + "件");
            }
            $("#cnum").val(maxqty);
            getTotalPrice(maxqty);
            return false;
        }
        else if (cnum < minqty) {
            showWaitingMask("不能少于最小购买数量" + minqty + "件");
            $("#cnum").val(minqty);
            getTotalPrice(minqty);
            return false;
        }
        if (qty < cnum) {
            $("#cnum").val(qty);
            showWaitingMask("购买数量不能大于可用库存");
            getTotalPrice(qty);
            return false;
        }
        data.ProductSysNo = productSysNo;
        data.Count = cnum;
        data.Price = $("#hidTotalPrice").val();
        data.Peried = $("#hidPeriod").val();
        data.PeriodPrice = $("#hidPeriodPrice").val();
        data.IsKillEnable = $("#hidIsKillEnable").val();
        data.IsSecKill = $("#hidIsSecKill").val();
        var isYs = $("#colorX ul").length;//获取是否有颜色属性
        var isCm = $("#colorY ul").length;//获取是否有尺码属性
        if (isYs > 0) {
            data.GroupValue1 = $("#colorX ul li[class='on']").first().attr("title");
            if (isCm > 0) {
                data.GroupValue2 = $("#colorY ul li[class='on']").first().attr("title");
            }
        }
        temp.push(data);
        $("#hidPostData").val(JSON.stringify(temp));
        $("#formCollectCart").submit();
    }

    function firstLoad(paramsForLoad) {
        var paras = paramsForLoad.replace("&lt;", "<").replace("&gt;", ">");
        $.ajax({
            url: '/XPMall/Product/LoadProductDetail' + paras,
            type: 'post',
            dataType: "json",
            beforeSend: function () {
                //提示加载
                $("#LoadingDiv").show();
            },
            complete: function () {
                $("#LoadingDiv").hide();
            },
            error: function (a, b, c) {
                var errorMsg = "出现JS异常，异常页面：" + window.location.href + ";错误信息：" + a.status + "_" + b + "_" + c;
                window.location = '/XPMall/Share/Error' + "?ErrorMsg=" + errorMsg;
            },
            success: function (data) {
                var jsonData = data;
                if (jsonData.Code == 1 || jsonData.Code == -1) {
                    showWaitingMask(jsonData.Message);
                } else {
                    var picList = jsonData.Data.PicList;
                    var PDt = jsonData.Data.ProductDt;
                    var Data = jsonData.Data;
                    $("#hidGroupNumber").val(jsonData.Data.GroupNumber);
                    if (picList && picList.length) {
                        ShowPic(picList);
                    }
                    if (PDt) {
                        ShowDetail(PDt);
                    }
                    ShowGroup(Data.GroupTitle, Data.Group1Value, Data.Group2Value, Data.Group1ValueList, Data.Group2ValueList);
                }
            }
        });
    }

    function ShowPic(picList) {
        if (picList.length > 0) {
            var items;
            if (picList.length == 1) {
                items = " <div class=\"block\"><div> ";
                items += " <img width=\"200\" height=\"200\" alt=\"\" src='" + picList[0] + "'> ";
                items += " </div></div> ";
            } else if (picList.length == 2) {
                items = " <div class=\"block\" style=\"z-index: 50\"><div> ";
                items += " <img width=\"200\" height=\"200\" alt=\"\" src='" + picList[0] + "'> ";
                items += " </div></div> ";

                items += " <div class=\"block\"><div> ";
                items += " <img width=\"200\" height=\"200\" alt=\"\" src='" + picList[1] + "'> ";
                items += " </div></div> ";
            } else {
                for (var i = 0; i < picList.length; i++) {
                    if (i == 0) {
                        items = " <div class=\"block\" style=\"z-index: 50\"><div> ";
                        items += " <img width=\"200\" height=\"200\" src='" + picList[0] + "'> ";
                        items += " </div></div> ";
                    } else {
                        items += " <div class=\"block\"><div> ";
                        items += " <img width=\"200\" height=\"200\" src='" + picList[i] + "'> ";
                        items += " </div></div> ";
                    }
                }
            }
            //$(".slideContainer").append(items);
        }
        //$("#detail img").attr("src", picList[0]);
    }

    function ShowDetail(item) {
        $("#detailInfo").empty();
        $("#detailForApp").empty();
        $("#performance").empty();
        var items;
        items = " <span>" + item.ProductName + "</span> ";
        items += " <br> ";
        var yP = item.OriginalPrice;
        items += " <small></small> ";

        items += " <font>惊喜价：<strong>" + item.Price + "</strong>元</font> ";
        $("#detailInfo").append(items);
        var items2;
        items2 = " <p>" + item.DetailForApp + "</p> ";
        $("#detailForApp").append(items2);
        //下面还有参数描述
        items3 = " <p>" + item.Performance + "</p> ";
        $("#performance").append(items3);
        //$("#pSL").text("1件");
        $("#pJE").text(item.Price + "元");
        $("#hidInventoryQty").val(item.InventoryQty);
        $("#hidPrice").val(item.Price);
        $("#detailForApp").show();
        $("#performance").hide();
    }

    function ShowGroup(GroupTitle, Group1Value, Group2Value, Group1ValueList, Group2ValueList) {
        if (!GroupTitle) {
            return false;
        }
        var GroupTitleM = GroupTitle.split('|');
        var Group1ValueListM = Group1ValueList.split('|');
        var Group2ValueListM = Group2ValueList.split('|');
        if (GroupTitleM.length > 0) {
            $("#colorX").empty();
            $("#colorY").empty();
            var items;
            items = " <span>" + GroupTitleM[0] + "：</span> ";
            items += " <ul> ";
            for (var i = 0; i < Group1ValueListM.length; i++) {
                if (Group1Value && Group1Value == Group1ValueListM[i] && !Group1ValueListM[i] == false) {
                    items += " <li onclick=\"checkYS(this)\" title='" + Group1ValueListM[i] + "' class=\"on\"><a href=\"#\">" + Group1ValueListM[i] + "</a></li> ";
                } else if (Group1Value && !Group1ValueListM[i] == false) {
                    items += " <li onclick=\"checkYS(this)\" title='" + Group1ValueListM[i] + "'><a href=\"#\">" + Group1ValueListM[i] + "</a></li> ";
                }
            }
            items += " <div class=\"clearer\"></div> ";
            items += " </ul> ";
            $("#colorX").append(items);
            if (GroupTitleM.length > 1) {
                var items2;
                items2 = " <span>" + GroupTitleM[1] + "：</span> ";
                items2 += " <ul> ";
                for (var i = 0; i < Group2ValueListM.length; i++) {
                    if (Group2Value && Group2Value == Group2ValueListM[i] && !Group2ValueListM[i] == false) {
                        items2 += " <li onclick=\"checkCM(this)\" title='" + Group2ValueListM[i] + "' class=\"on\"><a href=\"#\">" + Group2ValueListM[i] + "</a></li> ";
                    } else if (Group2Value && !Group2ValueListM[i] == false) {
                        items2 += " <li onclick=\"checkCM(this)\" title='" + Group2ValueListM[i] + "'><a href=\"#\">" + Group2ValueListM[i] + "</a></li> ";
                    }
                }
                items2 += " <div class=\"clearer\"></div> ";
                items2 += " </ul> ";
                $("#colorY").append(items2);
            }
        }
        //<span>尺码：</span>
        //<ul>
        //    <li><a href="#">灰色</a></li>
        //    <li><a href="#">金色</a></li>
        //    <li class="on"><a href="#">银色</a></li>
        //</ul>
        //<div class="clearer"></div>

    }

    function checkYS(obj) {
        //var fa1 = a1.parent();//获取上级
        var li = $(obj);
        var Group1Value = li.attr("title");
        var Group2Value;
        var GroupNumber = $("#hidGroupNumber").val();
        var params;
        li.siblings().removeAttr("class");
        li.attr("class", "on");
        var isCm = $("#colorY ul").length;//获取是否有尺码
        if (isCm <= 0) {//加载数据
            params = "?Group1Value=" + Group1Value + "&GroupNumber=" + GroupNumber + "&CK=1";
            //firstLoad(params);
            checkShopping(params);
            return false;
        }
        var isCmSelect = $("#colorY ul li[class='on']").length;//获取尺码选中个数
        if (isCmSelect > 0) {
            Group2Value = $("#colorY ul li[class='on']").attr("title");
            params = "?Group1Value=" + Group1Value + "&Group2Value=" + Group2Value + "&GroupNumber=" + GroupNumber + "&CK=1";
            //firstLoad(params);
            checkShopping(params);
            return false;
        }
    }

    function checkCM(obj) {
        var li = $(obj);
        var Group1Value;
        var Group2Value = li.attr("title");
        var GroupNumber = $("#hidGroupNumber").val();
        li.siblings().removeAttr("class");
        li.attr("class", "on");
        var isCmSelect = $("#colorX ul li[class='on']").length;//获取颜色选中个数
        if (isCmSelect > 0) {
            Group1Value = $("#colorX ul li[class='on']").attr("title");
            params = "?Group1Value=" + Group1Value + "&Group2Value=" + Group2Value + "&GroupNumber=" + GroupNumber + "&CK=2";
            //firstLoad(params);
            checkShopping(params);
            return false;
        }
    }

    function blurSL(obj) {
        var reg = /^[0-9]*$/;
        var cnum = $(obj).val().toString();
        var minqty = $("#hidMinQty").val();
        var maxqty = $("#hidMaxQty").val();
        minqty = parseInt(minqty);
        if (minqty < 1) {
            minqty = 1;
        }
        if (!reg.exec(cnum) || !cnum) {
            showWaitingMask("必须输入数字");
            $(obj).val(1);
            getTotalPrice(1);
            return false;
        } else {
            cnum = parseInt(cnum);
            maxqty = parseInt(maxqty);
            var qty = $("#hidInventoryQty").val();
            qty = parseInt(qty);
            var isMinKC = false;//判断库存是否小于最大限购数量
            if (qty < maxqty) {
                maxqty = qty;
                isMinKC = true;
            }
            if (qty < 0) {
                $(obj).val(0);
                showWaitingMask("商品可用库存不足");
                return false;
            }
            if (cnum > maxqty) {
                if (isMinKC) {
                    showWaitingMask("不能超过可用库存" + maxqty + "件");
                } else {
                    showWaitingMask("不能超过最大购买数量" + maxqty + "件");
                }
                $(obj).val(maxqty);
                getTotalPrice(maxqty);
                return false;
            } else if (cnum < minqty) {
                showWaitingMask("不能少于最小购买数量" + minqty + "件");
                $(obj).val(minqty);
                getTotalPrice(minqty);
            } else {
                //var mType = $("#hidMType").val();
                var mPeriod = $("#hidPeriod").val();
                var price;
                if (mPeriod == 1) {
                    price = $("#hidPrice").val();
                    price = parseFloat(price);
                    cnum = parseInt(cnum);
                    $("#iJEA").text(parseFloat(price * cnum).toFixed(2) + "元");
                } else {
                    price = $("#hidPrice").val();
                    price = parseFloat(price);
                    cnum = parseInt(cnum);
                    //price = parseFloat($("#hidPeriodPrice").val()) * parseInt($("#hidPeriod").val());
                }
                $("#hidTotalPrice").val(parseFloat(price * cnum).toFixed(2));
            }
        }
    }

    function getTotalPrice(cnum) {
        var mPeriod = $("#hidPeriod").val();
        var price;
        if (mPeriod == 1) {
            price = $("#hidPrice").val();
            price = parseFloat(price);
            cnum = parseInt(cnum);
            $("#iJEA").text(parseFloat(price * cnum).toFixed(2) + "元");
        } else {
            price = $("#hidPrice").val();
            price = parseFloat(price);
            cnum = parseInt(cnum);
            //price = parseFloat($("#hidPeriodPrice").val()) * parseInt($("#hidPeriod").val());
        }
        $("#hidTotalPrice").val(parseFloat(price * cnum).toFixed(2));
    }

    function checkShopping(paramsForLoad) {
        var params = paramsForLoad.replace("&lt;", "<").replace("&gt;", ">");

        window.location = '/XPMall/Product/ProductDetail' + params;
    }

    function showWaitingMask(errorMsg) {
        var panel = $(".MaskPanel");
        var content = $(".MaskContent");
        if (errorMsg) {
            content.find("P").text(errorMsg)
            content.find("input[type=button]").show();
        }
        panel.css("height", document.body.scrollHeight);
        panel.css("width", document.body.scrollWidth);
        panel.show();
        content.show();
    }

    function closeMask() {
        $(".MaskPanel").hide();
        $(".MaskContent").hide();
    }
</script>
<script type="text/javascript">
    if (document.all) {
        window.XMLHttpRequest = function () {
            var get = ['Microsoft.XMLHTTP', 'Msxml2.XMLHTTP'];
            for (var i = 0; i < get.length; i++) { try { return new ActiveXObject(get[i]) } catch (e) { } };
        };
    }

    //webDate = function (fn) {
    //    var Htime = new XMLHttpRequest();
    //    Htime.onreadystatechange = function () { Htime.readyState == 4 && (fn(new Date(Htime.getResponseHeader('Date')))) };
    //    Htime.open('HEAD', '?rnd=1235', true);
    //    Htime.send(null);
    //}

    var isKillEnable = $("#hidIsKillEnable").val();
    var isSecKills = $("#hidIsSecKill").val();
    var inventoryQty = $("#hidInventoryQty").val();
    var startTime = $("#hidSecStartTime").val();//'2015/04/8 22:25:00';
    var endTime = $("#hidSecEndTime").val();//'2015/04/8 22:30:04';
    var newTime = $("#hidNewTime").val();//'2015/04/8 22:30:04';
    //var startTime = '2015/04/09 22:25:00';
    //var endTime = '2015/04/09 22:30:04';
    if (isSecKills == '1') {
        var tspan = 0;//-22;
        //webDate(function (webTime) {
        //    tspan = webTime.getTime() - (new Date).getTime();
        //})
        var dt = new Date(newTime);
        dt.setTime(dt.getTime() + tspan);
        dt.setSeconds(dt.getSeconds() + 1);
        newTime = dt;

        comStart = parseInt((new Date(startTime).getTime() - dt) / 1000);
        comEnd = parseInt((new Date(endTime).getTime() - dt) / 1000);


                $("#hidIsKillEnable").val(1);
                $("#hTitle").html("活动剩余时间");
                initialTime(parseInt((new Date(endTime).getTime() - dt) / 1000));
                runTimeEnd();


    }

    function initialTime(sec) {
        //秒
        seconds = sec % 60;
        $("#bSecond").html(seconds);
        //分
        sec = Math.floor(sec / 60);
        minutes = sec % 60;
        $("#bMinute").html(minutes);
        //时
        sec = Math.floor(sec / 60);
        hours = sec % 24;
        $("#bHour").html(hours);
        //天
        days = Math.floor(sec / 24);
        $("#bDay").html(days);
    }

    function runTime() {
        var tspan = 22;//-22;
        //webDate(function (webTime) {
        //    tspan = webTime.getTime() - (new Date).getTime();
        //})
        var d = new Date(newTime);
        d.setTime(d.getTime() + tspan);
        d.setSeconds(d.getSeconds() + 1);
        newTime = d;
        var tmp = parseInt((new Date(startTime).getTime() - d) / 1000);

            $("#hidIsKillEnable").val(1);
            $("#tBuy").attr("href", "javascript:submit()");
            $("#tBuy").css("cursor", "");
            $("#tBuy").css("background-color", "");
            $("#hTitle").html("活动剩余时间");
            initialTime(parseInt((new Date(endTime).getTime() - d) / 1000));
            setTimeout('runTimeEnd()', 1000);

    }

    //设置秒杀仅剩多少秒
    function runTimeEnd() {
        var tspan = 22;//-22;
        //webDate(function (webTime) {
        //    tspan = webTime.getTime() - (new Date).getTime();
        //})
        var d1 = new Date(newTime);
        d1.setTime(d1.getTime() + tspan);
        d1.setSeconds(d1.getSeconds() + 1);
        newTime = d1;

        var tmp = parseInt((new Date(endTime).getTime() - d1) / 1000);

            $("#hidIsKillEnable").val(1);
            $("#tBuy").attr("href", "javascript:submit()");
            $("#aBuy").css("cursor", "");
            $("#tBuy").css("background-color", "");
            initialTime(tmp);
            setTimeout('runTimeEnd()', 1000);

    }

</script>
